# Работа с базами данных, пользователями и правами

1. Зашёл в созданный кластер под пользователем postgres и создал новую базу данных testdb ![1.png](images/1.png)
2. Зашёл в созданную базу данных под пользователем postgres и созздал новую схему testnm ![2.png](images/2.png) ![3.png](images/3.png)
3. Создал новую таблицу t1 с одной колонкой c1 типа integer и добавил строку со значением c1=1 ![4.png](images/4.png)
4. Создал новую роль readonly и дал новой роли право на подключение к базе данных testdb, на использование схемы testnm, на select для всех таблиц схемы testnm ![5.png](images/5.png)
5. Создал пользователя testread с паролем test123 и дал ему роль readonly пользователю testread ![6.png](images/6.png)
6. Подключился под пользователем testread в базу данных testdb и сделал select * from t1 ![7.png](images/7.png) ![8.png](images/8.png)
7. Отказано в правах доступа, так как при создании таблицы не была указана схема, в которой будет данная таблица, а по умолчанию всегда стоит схема public, к которой мы не дал доступа пользователю testread
8. Зашёл в базу данных testdb под пользователем postgres и удалил таблицу t1, создал ее заново но уже с явным указанием имени схемы testnm и вставил строку со значением c1=1 зашёл под пользователем testread в базу данных testdb и сделал select * from testnm.t1 ![9.png](images/9.png) ![10.png](images/10.png)
9. Отказано в правах доступа, так как ранее данные права на select были установлены только для таблиц созданных в схеме testnm на тот момент, когда мы выдавили права, а та таблица t1 была удалена
10. После использования команды ALTER default privileges проблема не решилась, так как она применится для новых созданных таблиц в схеме testnm ![11.png](images/11.png)
11. Поэтому пересоздадим таблицу заново и получим результат ![12.png](images/12.png)
12. Выполнил команду create table t2(c1 integer); insert into t2 values (2) ![13.png](images/13.png)
13. Всё успешно создалось, так как новые созданные пользователи по умолчанию получают роль public и могут пользоваться схемой public
14. Чтоб решить эту проблему, можно просто отменить права на создание таблиц для роли public в схеме public ![14.png](images/14.png)